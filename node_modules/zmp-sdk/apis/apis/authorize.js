import o from'./../external/@swc/helpers/src/_async_to_generator.mjs.js';import r from"../appEnv/index.js";import t from"../common/notFound.js";import{functionHandler as e}from"../utils/decorator.js";import s from"../common/apis/general/authorize.js";import i,{object as n,string as m}from'./../external/zod/lib/index.mjs.js';import{apiResponse as p}from"../utils/response.js";import{getZaloVersionCode as a}from"../common/utils.js";import{__generator as u}from'./../external/tslib/tslib.es6.js';import l from"../appEnv/getEnv.js";var c=[n({scopes:i.array(m()).max(2).optional()}).optional()];function f(o){return d.apply(this,arguments)}function d(){return d=o((function(i){return u(this,(function(n){return[2,e("authorize",c,[i],(m=o((function(o){var e,i,n,m;return u(this,(function(u){switch(u.label){case 0:return r.isMp?(i=null==o?void 0:o.scopes,n=a(),("android"===(m=((null===(e=l())||void 0===e?void 0:e.platformName)||"").toLowerCase())&&n<724||"ios"===m&&n<573)&&i&&i.length>0?[2,Promise.reject(p.error.clientNotSupport())]:[4,s(null!=i?i:void 0)]):[3,2];case 1:return[2,u.sent()];case 2:return r.isMpWeb?[2,Promise.resolve({})]:[2,Promise.reject(t("authorize",{}))]}}))})),function(o){return m.apply(this,arguments)}))];var m}))})),d.apply(this,arguments)}export{f as authorize};
